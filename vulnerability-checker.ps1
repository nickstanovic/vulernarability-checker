# Define a list of ports that are commonly associated with vulnerabilities
$exploitPorts = @(
    21,     # FTP
    22,     # SSH
    23,     # Telnet
    25,     # SMTP
    80,     # HTTP
    110,    # POP3
    135,    # MS RPC
    139,    # NetBIOS
    445,    # SMB
    1433,   # MS SQL
    3306,   # MySQL
    3389    # RDP
)

# Get all open ports on the system
$openPorts = Get-NetTCPConnection | Where-Object { $_.State -eq "Established" } | Select-Object -Unique OwningProcess,LocalPort

# Display the open ports and highlight the ones that are in the exploitPorts list
foreach ($port in $openPorts) {
    if ($exploitPorts -contains $port.LocalPort) {
        Write-Host "WARNING: Port $($port.LocalPort) (Process ID: $($port.OwningProcess)) is open and is commonly associated with vulnerabilities!" -ForegroundColor Red
    } else {
        Write-Host "Port $($port.LocalPort) (Process ID: $($port.OwningProcess)) is open." -ForegroundColor Green
    }
}
