# Define a list of ports that are commonly associated with vulnerabilities
$exploitPorts = @(
    21,     # FTP
    22,     # SSH
    23,     # Telnet
    25,     # SMTP
    80,     # HTTP
    110,    # POP3
    135,    # MS RPC
    139,    # NetBIOS
    445,    # SMB
    1433,   # MS SQL
    3306,   # MySQL
    3389    # RDP
)

# Get all open ports on the system
$openPorts = Get-NetTCPConnection | Where-Object { $_.State -eq "Established" } |
             Select-Object -Unique OwningProcess,LocalPort | ForEach-Object {
                $processName = (Get-Process -Id $_.OwningProcess -ErrorAction SilentlyContinue).ProcessName
                [PSCustomObject]@{
                    'Port'        = $_.LocalPort
                    'Process ID'  = $_.OwningProcess
                    'Process Name'= $processName
                }
             } | Sort-Object Port

# Display header
Write-Host "`nPort    | Process ID | Process Name" -ForegroundColor Yellow

# Display the open ports and highlight the ones that are in the exploitPorts list
foreach ($port in $openPorts) {
    if ($exploitPorts -contains $port.Port) {
        Write-Host ("{0,-8} | {1,-10} | {2}" -f $port.Port, $port.'Process ID', $port.'Process Name') -ForegroundColor Red
    } else {
        Write-Host ("{0,-8} | {1,-10} | {2}" -f $port.Port, $port.'Process ID', $port.'Process Name') -ForegroundColor Green
    }
}
